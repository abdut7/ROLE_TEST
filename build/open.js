!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e,t="errCommon"){if(super(),this.isError=!1,Error.captureStackTrace(this,this.constructor),"errServer"==t&&(t="errCommon",console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),void 0!==e.isError&&(this.isError=e.isError),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;this[t]=[],e instanceof Error?(console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else e&&(this[t]=[],this[t].push({strMessage:e}),this.isError=!0)}add(e,t="errCommon"){if("errServer"==t&&(t="errCommon",console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;void 0===this[t]&&(this[t]=[]),e instanceof Error?(console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else void 0===this[t]&&(this[t]=[]),this[t].push({strMessage:e}),this.isError=!0}setStatus(e){return this.HTTP_R_S_Code=e,this}send({statusCode:e=400}={}){let t=[];return this.errCommon.length&&this.errCommon.forEach(e=>{t.push(e.strMessage)}),this.HTTP_R_S_Code&&(e=this.HTTP_R_S_Code),{body:{arrErrors:t},statusCode:e}}}t.default=n},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(13)),n(r(14)),n(r(17)),n(r(20)),n(r(23))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(5)),n(r(15)),n(r(16))},function(e,t){e.exports=require("mongodb")},function(e,t){e.exports=require("express")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLN_USER="cln_user",t.CLN_USER_ROLE="cln_user_role",t.CLN_MODULE="cln_module",t.CLN_ROLE_PERMISSION="cln_role_permission"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(27);let o=n.inserManyDBFactory();t.inserManyDB=o;let s=n.inserOneDBFactory();t.inserOneDB=s;let a=n.getListDBFactory();t.getListDB=a;let i=n.getOneDBFactory();t.getOneDB=i;let u=n.deleteDBFactory();t.deleteDB=u;let l=n.updateOneDBFactory();t.updateOneDB=l;let c=n.deleteManyDBFactory();t.deleteManyDB=c;let d=n.getRolePermissionFactory();t.getRolePermission=d},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(4)),s=r(8),a=n(r(9)),i=n(r(10)),u=n(r(0)),l=n(r(11)),c=r(1),d=o.default();try{c.createMongoDbConnection(),d.use(i.default()),d.use(a.default.json()),d.use(a.default.urlencoded({limit:"50mb",extended:!0})),d.use((function(e,t,r,n){e instanceof SyntaxError&&"body"in e?r.status(400).send({errCommon:[{strMessage:"INVALID_JSON"}]}):n()})),d.use("/",l.default),d.listen(s.intPort,(function(){console.log("App is listening on port "+s.intPort)}))}catch(e){console.log(new u.default(e).send().body)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.intPort=4e3},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let o=n(r(4)).default.Router();o.use("/user",r(12)),t.default=o},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(4)),s=r(1),a=r(25);let i=o.default.Router();i.post("/login_user",s.makeController(a.logInUserController)),e.exports=i},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.makeController=function(e){return async(t,r)=>{try{const n=await({body:t.body,query:t.query,params:t.params,ip:t.ip,strToken:t.strToken,strUserId:t.strUserId,strUserRole:t.strUserRole,method:t.method,timReceived:new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})),path:t.originalUrl,strAudience:(t.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":t.get("Content-Type"),Referer:t.get("referer"),"User-Agent":t.get("User-Agent")}});console.log("ObjRequst Body\n :",new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))),console.log(t.body),await e(n).then(({headers:e={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))},type:t="json",statusCode:o=200,body:s})=>{if(!s)throw new Error("EMPTY_RESPONSE");r.set(e),r.type(t),400==o?r.status(o).send({...s,blnAPIStatus:!1}):r.status(o).send({...s,blnAPIStatus:!0,strToken:n.strToken})}).catch(async e=>{let t=new o.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...t.body,blnAPIStatus:!1})})}catch(e){let t=new o.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...t.body,blnAPIStatus:!1})}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(3),s=n(r(0)),a=r(2);let i;async function u(){try{i=await o.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-00.yoytl.mongodb.net:27017",{useUnifiedTopology:!0}),console.log("MongoClient Created")}catch(e){throw new s.default(e)}}t.createMongoDbConnection=u,t.getMongoDbConnection=async function(){try{return i||await u(),i.db(a.STR_COMMON_DB)}catch(e){throw new s.default(e)}},t.getMongoDbTransConnection=async function(){try{let e=await o.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-02.yoytl.mongodb.net:27017",{useUnifiedTopology:!0}),t=await e.db(a.STR_COMMON_DB),r=await e.startSession();return await r.startTransaction({readConcern:{level:"snapshot"},writeConcern:{w:"majority"}}),{objTransactionClient:e,objConnection:t,objSession:r}}catch(e){throw new s.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STR_COMMON_DB_TENANT_ID="ROLE",t.STR_COMMON_DB="ROLE"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrModule=[{strName:"USER",blnCreate:!0,blnUpdate:!0,blnDelete:!0,blnListView:!0,chrStatus:"N"},{strName:"ROLE",blnCreate:!0,blnUpdate:!0,blnDelete:!0,blnListView:!0,chrStatus:"N"}]},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(18)),s=n(r(19)),a=n(r(0));t.hashString=function(e){return new Promise((function(t,r){try{e.length>0?o.default.genSalt(10,(function(r,n){o.default.hash(e,n,(function(e,r){t(r)}))})):r("NULL_INPUT_RECVD")}catch(e){throw new a.default(e)}}))},t.compareHashAndText=function(e,t){return new Promise((async function(r,n){try{if(e&&t){r(await o.default.compareSync(e,t))}else n("NULL_INPUT_RECVD")}catch(e){throw new a.default(e)}}))},t.encryptString=async function(e){return e?(await s.default.AES.encrypt(e,"cartme123")).toString():e},t.decryptString=async function(e){if(!e)return e;console.log("11"),console.log(e);let t=await s.default.AES.decrypt(e,"cartme123");return console.log("12"),console.log(t.toString(s.default.enc.Utf8)),console.log("12"),t.toString(s.default.enc.Utf8)}},function(e,t){e.exports=require("bcryptjs")},function(e,t){e.exports=require("crypto-js")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(21)),s=n(r(0)),a=n(r(22));t.jwtSignIn=async function(e,t){try{let r=await a.default.readFileSync("./config/private.key","utf-8"),n=await({issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256"});return await o.default.sign(e,r,n)}catch(e){throw new s.default(e)}},t.jwtVerify=async function(e,t){try{let r=await a.default.readFileSync("./config/public.key","utf-8"),n={issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256",expiresIn:"300d"};return o.default.verify(e,r,n)}catch(e){throw new s.default(e)}},t.jwtDecode=async function(e){try{return o.default.decode(e,{complete:!0})}catch(e){throw new s.default(e)}}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(24)),s=n(r(0));async function a(){try{return await o.default.createClient()}catch(e){throw new s.default(e)}}t.initializeRedisConn=a,t.setRedisData=async function(e,t){let r=await a();try{return await r.on("error",(function(e){console.error(e)})),r.set(e,t,o.default.print)}catch(e){throw new s.default(e)}finally{await r.quit()}},t.getRedisData=async function(e){let t=await a();return new Promise((function(r,n){try{t.get(e,(function(e,t){t&&r(t),r(null)}))}catch(e){n(new s.default(e))}finally{t.quit()}}))},t.checkPartialKeyExist=async function(e){let t=await a();return new Promise((function(r,n){try{return t.keys(e+"*",(function(e,t){t&&r(t),r(null)}))}catch(e){n(new s.default(e))}finally{t.quit()}}))}},function(e,t){e.exports=require("redis")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(26),o=r(28);let s=n.createUserControllerFactory({createUserUsecase:o.createUserUsecase});t.createUserController=s;let a=n.logInUserControllerFactory({logInUserUseCase:o.logInUserUseCase});t.logInUserController=a;let i=n.deleteUserControllerFactory({deleteUserUsecase:o.deleteUserUsecase});t.deleteUserController=i;let u=n.getListUserControllerFactory({getUserUsecase:o.getUserUsecase});t.getListUserController=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(6);t.createUserControllerFactory=function({createUserUsecase:e}){return async function({body:t,...r}){try{let n=await s.getRolePermission({strModule:"USER",strRoleName:r.strUserRole});if(n&&n.blnCreate)return{body:await e({source:r,body:t})};throw new o.default("YOU HAVE NO PERMISSION")}catch(e){return new o.default(e).send()}}},t.getListUserControllerFactory=function({getUserUsecase:e}){return async function({body:t,...r}){try{let n=await s.getRolePermission({strModule:"USER",strRoleName:r.strUserRole});if(n&&n.blnListView)return{body:await e({source:r,body:t})};throw new o.default("YOU HAVE NO PERMISSION")}catch(e){return new o.default(e).send()}}},t.logInUserControllerFactory=function({logInUserUseCase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new o.default(e).send()}}},t.deleteUserControllerFactory=function({deleteUserUsecase:e}){return async function({body:t,...r}){try{let n=await s.getRolePermission({strModule:"USER",strRoleName:r.strUserRole});if(n&&n.blnDelete)return{body:await e({source:r,body:t})};throw new o.default("YOU HAVE NO PERMISSION")}catch(e){return new o.default(e).send()}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(5),s=r(1),a=n(r(0));t.getListDBFactory=function(){return async function({strCollection:e,arrQuery:t}){try{return(await s.getMongoDbConnection()).collection(e).aggregate(t).toArray()}catch(e){throw new a.default(e)}}},t.getOneDBFactory=function(){return async function({strCollection:e,objSet:t=null,objQuery:r}){try{let n=await s.getMongoDbConnection();if(t){return(await n.collection(e).findOneAndUpdate(r,{$set:t})).value}return n.collection(e).findOne(r)}catch(e){throw new a.default(e)}}},t.inserManyDBFactory=function(){return async function({strCollection:e,arrInsertDocuments:t}){try{let r=await s.getMongoDbConnection();return await r.collection(e).insertMany(t),{strMessage:"Success"}}catch(e){throw new a.default(e)}}},t.inserOneDBFactory=function(){return async function({strCollection:e,objDocument:t}){try{return(await s.getMongoDbConnection()).collection(e).insertOne(t)}catch(e){throw new a.default(e)}}},t.updateOneDBFactory=function(){return async function({strCollection:e,objQuery:t,objDocument:r}){try{let n=await s.getMongoDbConnection();return await n.collection(e).updateOne(t,{$set:r}),{strMessage:"UPDATE_SUCCESS"}}catch(e){throw new a.default(e)}}},t.deleteManyDBFactory=function(){return async function({strCollection:e,objQuery:t}){try{let r=await s.getMongoDbConnection();return await r.collection(e).deleteMany(t),{strMessage:"UPDATE_SUCCESS"}}catch(e){throw new a.default(e)}}},t.getRolePermissionFactory=function(){return async function({strRoleName:e,strModule:t}){try{return(await s.getMongoDbConnection()).collection(o.CLN_ROLE_PERMISSION).findOne({chrStatus:"N",strRoleName:e,strName:t})}catch(e){throw new a.default(e)}}},t.deleteDBFactory=function(){return async function({strCollection:e,arrDeleteId:t,strModifiedTime:r,strModifiedUser:n}){let o=await s.getMongoDbConnection();try{if((await o.collection(e).find({_id:{$in:t}}).toArray()).length!=t.length)throw new a.default("ITEM_MISMACTH");return await o.collection(e).updateMany({_id:{$in:t}},{$set:{chrStatus:"D",strModifiedTime:r,strModifiedUser:n}}),{}}catch(e){throw new a.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(29),s=r(31),a=r(6),i=n(r(33)),u=n(r(34)),l=n(r(35)),c=n(r(36));let d=i.default({createUserDb:o.createUserDb,userEntity:s.userEntity});t.createUserUsecase=d;let f=u.default({getListDB:a.getListDB});t.getUserUsecase=f;let y=l.default({getUserDetailsDb:o.getUserDetailsDb});t.logInUserUseCase=y;let _=c.default({deleteDB:a.deleteDB});t.deleteUserUsecase=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(30);let o=n.createUserDbFactory();t.createUserDb=o;let s=n.getUserDetailsDbFactory();t.getUserDetailsDb=s;let a=n.getListUserDBFactory();t.getListUserDB=a;let i=n.updateUserDbFactory();t.updateUserDb=i},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0)),a=r(2),i=r(3);t.createUserDbFactory=function(){return async function({objUser:e}){let t=await o.getMongoDbConnection();try{return await t.collection(a.CLN_USER).insertOne(e),{strMessage:"Success"}}catch(e){let t={strName:"USER NAME ALREADY EXIST",strMobileNo:"MOBILE NUMBER ALREADY EXIST"},r=new s.default;if("MongoError"==e.name&&"11000"==e.code&&(e.keyValue.strName&&r.add(t.strName),e.keyValue.strMobileNo&&r.add(t.strMobileNo),r.isError))throw r;throw new s.default(e)}}},t.updateUserDbFactory=function(){return async function({objQuery:e,objSetUser:t,strTenantId:r}){let n=await o.getMongoDbConnection();try{return(await n.collection(a.CLN_USER).findOneAndUpdate(e,t)).value}catch(e){let t={strName:"USER NAME ALREADY EXIST",strMobileNo:"MOBILE NUMBER ALREADY EXIST",strEmail:"EMAIL ALREADY EXIST"},r=new s.default;if("MongoError"==e.name&&"11000"==e.code&&(e.keyValue.strName&&r.add(t.strName),e.keyValue.strMobileNo&&r.add(t.strMobileNo),e.keyValue.strEmail&&r.add(t.strEmail),r.isError))throw r;throw new s.default(e)}}},t.getListUserDBFactory=function(){return async function({strTenantId:e,arrQuery:t,strType:r}){let n=await o.getMongoDbConnection();try{let e=await n.collection(a.CLN_USER).aggregate(t).toArray();return e.length?(t.pop(),t.pop(),t.push({$count:"intTotalCount"}),{arrList:e,objCount:await n.collection(a.CLN_USER).aggregate(t).toArray()}):{arrList:e,objCount:[{intTotalCount:0}]}}catch(e){throw new s.default(e)}}},t.getUserDetailsDbFactory=function(){return async function({strName:e=null,strMobileNo:t=null,strUserPK:r=null}){let n=await o.getMongoDbConnection();try{let o={chrStatus:"N"};e?o.strName=e:t?o.strMobileNo=t:r&&(o._id=new i.ObjectID(r));let u={};if(u=await n.collection(a.CLN_USER).findOne(o),!u)throw new s.default("INVALID_USER_NAME");return u}catch(e){throw new s.default(e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(32);let o=n.userEntityFactory();t.userEntity=o;let s=n.userUpdateEntityFactory();t.userUpdateEntity=s},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(1),a=r(3);t.userEntityFactory=function(){return async function({strName:e,strMobileNo:t,strPassword:r,strUserRole:n,strCreatedTime:i,strCreatedUser:u}){try{let l=new o.default;if(e||l.add("NAME_EMPTY"),r||l.add("PASSWORD_ERROR"),l.isError)throw l;if(l.isError)throw l;return{objUser:{strName:e,strMobileNo:t,strHashPassword:await s.hashString(r.trim()),strUserRole:n,chrStatus:"N",strCreatedTime:i||null,strCreatedUser:new a.ObjectID(u)||null}}}catch(e){throw new o.default(e)}}},t.userUpdateEntityFactory=function(){return async function({strName:e,strMobileNo:t,strPassword:r,strUserRole:n,strCreatedTime:i,strCreatedUser:u}){try{let l=new o.default;if(e||l.add("NAME_EMPTY"),r||l.add("PASSWORD_ERROR"),l.isError)throw l;if(l.isError)throw l;return{objUser:{strName:e,strMobileNo:t,strHashPassword:await s.hashString(r.trim()),strUserRole:n,chrStatus:"N",strCreatedTime:i||null,strCreatedUser:new a.ObjectID(u)||null}}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0));t.default=function({createUserDb:e,userEntity:t}){return async function({source:r,body:n}){try{let o=await t({...n,strCreatedTime:r.timReceived,strCreatedUser:r.strUserId});return e({objUser:o.objUser})}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(r(0)),s=r(2);t.default=function({getListDB:e}){return async function({source:t,body:r}){try{t.strUserId;let n={$and:[]};n.$and.push({chrStatus:"N"});let o=[];if(o.push({$match:n}),r.strSort){let e={$sort:{[r.strSort]:"ASC"==r.strSortActive?1:-1}};o.push(e)}let a=Number(r.intPageNo)*Number(r.intLimit&&""!=r.intLimit?r.intLimit:20),i=r.intLimit&&""!=r.intLimit?r.intLimit:20;return await o.push({$limit:Number(i)}),await o.push({$skip:a||0}),{arrList:await e({strCollection:s.CLN_USER,arrQuery:o}),intLimit:i,intPageNo:r.intPageNo||0,...r}}catch(e){throw new o.default(e)}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(1),s=n(r(0)),a=r(2);t.default=function({getUserDetailsDb:e}){return async function({source:t,body:r}){if((r.strName||r.strMobileNo)&&!r.strPassword)throw new s.default("CREDENTIAL_MISSING");let n=await e({strName:r.strName||null,strMobileNo:r.strMobileNo||null}),i="";if(!await o.compareHashAndText(r.strPassword,n.strHashPassword))throw new s.default("CREDENTIAL_INVALID");return i=await o.jwtSignIn({strUserId:n._id.toString(),strUserRole:n.strUserRole},{issuer:"ABDU",subject:"123",audience:a.STR_COMMON_DB_TENANT_ID}),delete n.strHashPassword,{strUserToken:i,...n}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(2),s=n(r(0)),a=r(3);t.default=function({deleteDB:e}){return async function({source:t,body:r}){try{let n=[];return r.arrDeleteId.forEach(e=>{n.push(new a.ObjectID(e))}),await e({arrDeleteId:n,strCollection:o.CLN_USER,strModifiedTime:t.timReceived,strModifiedUser:t.strUserId}),{strMessage:"DELETE_SUCCESS"}}catch(e){throw new s.default(e)}}}}]);