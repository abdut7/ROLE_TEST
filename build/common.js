!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o extends Error{constructor(e,t="errCommon"){if(super(),this.isError=!1,Error.captureStackTrace(this,this.constructor),"errServer"==t&&(t="errCommon",console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),void 0!==e.isError&&(this.isError=e.isError),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;this[t]=[],e instanceof Error?(console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else e&&(this[t]=[],this[t].push({strMessage:e}),this.isError=!0)}add(e,t="errCommon"){if("errServer"==t&&(t="errCommon",console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e)),"object"==typeof e){if(void 0!==e.errCommon&&(this.errCommon=e.errCommon),void 0!==e.errModuleWise&&(this.errModuleWise=e.errModuleWise),void 0!==e.HTTP_R_S_Code&&(this.HTTP_R_S_Code=e.HTTP_R_S_Code),e.errCommon||e.errModuleWise||e.HTTP_R_S_Code)return this;void 0===this[t]&&(this[t]=[]),e instanceof Error?(console.log(`\n${new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})).toUTCString()} :-`),console.log(e),this[t].push({strMessage:"SOMETHING_WENT_WRONG"})):this[t].push({strMessage:e.strMessage,objDetails:e.objDetails}),this.isError=!0}else void 0===this[t]&&(this[t]=[]),this[t].push({strMessage:e}),this.isError=!0}setStatus(e){return this.HTTP_R_S_Code=e,this}send({statusCode:e=400}={}){let t=[];return this.errCommon.length&&this.errCommon.forEach(e=>{t.push(e.strMessage)}),this.HTTP_R_S_Code&&(e=this.HTTP_R_S_Code),{body:{arrErrors:t},statusCode:e}}}t.default=o},function(e,t,r){"use strict";function o(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),o(r(6)),o(r(15)),o(r(16))},function(e,t,r){"use strict";function o(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),o(r(13)),o(r(14)),o(r(17)),o(r(20)),o(r(23))},function(e,t){e.exports=require("mongodb")},function(e,t){e.exports=require("express")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(27);let n=o.inserManyDBFactory();t.inserManyDB=n;let s=o.inserOneDBFactory();t.inserOneDB=s;let a=o.getListDBFactory();t.getListDB=a;let i=o.getOneDBFactory();t.getOneDB=i;let l=o.deleteDBFactory();t.deleteDB=l;let u=o.updateOneDBFactory();t.updateOneDB=u;let c=o.deleteManyDBFactory();t.deleteManyDB=c;let d=o.getRolePermissionFactory();t.getRolePermission=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLN_USER="cln_user",t.CLN_USER_ROLE="cln_user_role",t.CLN_MODULE="cln_module",t.CLN_ROLE_PERMISSION="cln_role_permission"},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(4)),s=r(8),a=o(r(9)),i=o(r(10)),l=o(r(0)),u=o(r(11)),c=r(2),d=r(47),f=n.default();try{c.createMongoDbConnection(),f.use(i.default()),f.use(d.jwtTokenChecking),f.use(a.default.json({limit:"50mb"})),f.use(a.default.urlencoded({limit:"50mb",extended:!0})),f.use((function(e,t,r,o){e instanceof SyntaxError&&"body"in e?r.status(400).send({errCommon:[{strMessage:"INVALID_JSON"}]}):o()})),f.use("/",u.default),f.listen(s.intPort,(function(){console.log("App is listening on port "+s.intPort)}))}catch(e){console.log(new l.default(e).send().body)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.intPort=4001},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("cors")},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=o(r(4)).default.Router();n.use("/user",r(12)),n.use("/role",r(37)),t.default=n},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(4)),s=r(2),a=r(25);let i=n.default.Router();i.post("/create_user",s.makeController(a.createUserController)),i.post("/delete_user",s.makeController(a.deleteUserController)),i.post("/get_user",s.makeController(a.getListUserController)),e.exports=i},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0));t.makeController=function(e){return async(t,r)=>{try{const o=await({body:t.body,query:t.query,params:t.params,ip:t.ip,strToken:t.strToken,strUserId:t.strUserId,strUserRole:t.strUserRole,method:t.method,timReceived:new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})),path:t.originalUrl,strAudience:(t.get("str-audience")||"").toUpperCase(),headers:{"Content-Type":t.get("Content-Type"),Referer:t.get("referer"),"User-Agent":t.get("User-Agent")}});console.log("ObjRequst Body\n :",new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))),console.log(t.body),await e(o).then(({headers:e={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))},type:t="json",statusCode:n=200,body:s})=>{if(!s)throw new Error("EMPTY_RESPONSE");r.set(e),r.type(t),400==n?r.status(n).send({...s,blnAPIStatus:!1}):r.status(n).send({...s,blnAPIStatus:!0,strToken:o.strToken})}).catch(async e=>{let t=new n.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...t.body,blnAPIStatus:!1})})}catch(e){let t=new n.default(e).send();r.status(t.statusCode).set({"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))}).send({...t.body,blnAPIStatus:!1})}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=o(r(0)),a=r(1);let i;async function l(){try{i=await n.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-00.yoytl.mongodb.net:27017",{useUnifiedTopology:!0}),console.log("MongoClient Created")}catch(e){throw new s.default(e)}}t.createMongoDbConnection=l,t.getMongoDbConnection=async function(){try{return i||await l(),i.db(a.STR_COMMON_DB)}catch(e){throw new s.default(e)}},t.getMongoDbTransConnection=async function(){try{let e=await n.MongoClient.connect("mongodb+srv://abdut7:Rahman1**@cluster0.yoytl.mongodb.net/?retryWrites=true&w=majority&replicaSet=cluster0-shard-00-02.yoytl.mongodb.net:27017",{useUnifiedTopology:!0}),t=await e.db(a.STR_COMMON_DB),r=await e.startSession();return await r.startTransaction({readConcern:{level:"snapshot"},writeConcern:{w:"majority"}}),{objTransactionClient:e,objConnection:t,objSession:r}}catch(e){throw new s.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STR_COMMON_DB_TENANT_ID="ROLE",t.STR_COMMON_DB="ROLE"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrModule=[{strName:"USER",blnCreate:!0,blnUpdate:!0,blnDelete:!0,blnListView:!0,chrStatus:"N"},{strName:"ROLE",blnCreate:!0,blnUpdate:!0,blnDelete:!0,blnListView:!0,chrStatus:"N"}]},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(18)),s=o(r(19)),a=o(r(0));t.hashString=function(e){return new Promise((function(t,r){try{e.length>0?n.default.genSalt(10,(function(r,o){n.default.hash(e,o,(function(e,r){t(r)}))})):r("NULL_INPUT_RECVD")}catch(e){throw new a.default(e)}}))},t.compareHashAndText=function(e,t){return new Promise((async function(r,o){try{if(e&&t){r(await n.default.compareSync(e,t))}else o("NULL_INPUT_RECVD")}catch(e){throw new a.default(e)}}))},t.encryptString=async function(e){return e?(await s.default.AES.encrypt(e,"cartme123")).toString():e},t.decryptString=async function(e){if(!e)return e;console.log("11"),console.log(e);let t=await s.default.AES.decrypt(e,"cartme123");return console.log("12"),console.log(t.toString(s.default.enc.Utf8)),console.log("12"),t.toString(s.default.enc.Utf8)}},function(e,t){e.exports=require("bcryptjs")},function(e,t){e.exports=require("crypto-js")},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(21)),s=o(r(0)),a=o(r(22));t.jwtSignIn=async function(e,t){try{let r=await a.default.readFileSync("./config/private.key","utf-8"),o=await({issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256"});return await n.default.sign(e,r,o)}catch(e){throw new s.default(e)}},t.jwtVerify=async function(e,t){try{let r=await a.default.readFileSync("./config/public.key","utf-8"),o={issuer:t.issuer,subject:t.subject,audience:t.audience,algorithm:"RS256",expiresIn:"300d"};return n.default.verify(e,r,o)}catch(e){throw new s.default(e)}},t.jwtDecode=async function(e){try{return n.default.decode(e,{complete:!0})}catch(e){throw new s.default(e)}}},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("fs")},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(24)),s=o(r(0));async function a(){try{return await n.default.createClient()}catch(e){throw new s.default(e)}}t.initializeRedisConn=a,t.setRedisData=async function(e,t){let r=await a();try{return await r.on("error",(function(e){console.error(e)})),r.set(e,t,n.default.print)}catch(e){throw new s.default(e)}finally{await r.quit()}},t.getRedisData=async function(e){let t=await a();return new Promise((function(r,o){try{t.get(e,(function(e,t){t&&r(t),r(null)}))}catch(e){o(new s.default(e))}finally{t.quit()}}))},t.checkPartialKeyExist=async function(e){let t=await a();return new Promise((function(r,o){try{return t.keys(e+"*",(function(e,t){t&&r(t),r(null)}))}catch(e){o(new s.default(e))}finally{t.quit()}}))}},function(e,t){e.exports=require("redis")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(26),n=r(28);let s=o.createUserControllerFactory({createUserUsecase:n.createUserUsecase});t.createUserController=s;let a=o.logInUserControllerFactory({logInUserUseCase:n.logInUserUseCase});t.logInUserController=a;let i=o.deleteUserControllerFactory({deleteUserUsecase:n.deleteUserUsecase});t.deleteUserController=i;let l=o.getListUserControllerFactory({getUserUsecase:n.getUserUsecase});t.getListUserController=l},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(5);t.createUserControllerFactory=function({createUserUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"USER",strRoleName:r.strUserRole});if(o&&o.blnCreate)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}},t.getListUserControllerFactory=function({getUserUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"USER",strRoleName:r.strUserRole});if(o&&o.blnListView)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}},t.logInUserControllerFactory=function({logInUserUseCase:e}){return async function({body:t,...r}){try{return{body:await e({source:r,body:t})}}catch(e){return new n.default(e).send()}}},t.deleteUserControllerFactory=function({deleteUserUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"USER",strRoleName:r.strUserRole});if(o&&o.blnDelete)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(6),s=r(2),a=o(r(0));t.getListDBFactory=function(){return async function({strCollection:e,arrQuery:t}){try{return(await s.getMongoDbConnection()).collection(e).aggregate(t).toArray()}catch(e){throw new a.default(e)}}},t.getOneDBFactory=function(){return async function({strCollection:e,objSet:t=null,objQuery:r}){try{let o=await s.getMongoDbConnection();if(t){return(await o.collection(e).findOneAndUpdate(r,{$set:t})).value}return o.collection(e).findOne(r)}catch(e){throw new a.default(e)}}},t.inserManyDBFactory=function(){return async function({strCollection:e,arrInsertDocuments:t}){try{let r=await s.getMongoDbConnection();return await r.collection(e).insertMany(t),{strMessage:"Success"}}catch(e){throw new a.default(e)}}},t.inserOneDBFactory=function(){return async function({strCollection:e,objDocument:t}){try{return(await s.getMongoDbConnection()).collection(e).insertOne(t)}catch(e){throw new a.default(e)}}},t.updateOneDBFactory=function(){return async function({strCollection:e,objQuery:t,objDocument:r}){try{let o=await s.getMongoDbConnection();return await o.collection(e).updateOne(t,{$set:r}),{strMessage:"UPDATE_SUCCESS"}}catch(e){throw new a.default(e)}}},t.deleteManyDBFactory=function(){return async function({strCollection:e,objQuery:t}){try{let r=await s.getMongoDbConnection();return await r.collection(e).deleteMany(t),{strMessage:"UPDATE_SUCCESS"}}catch(e){throw new a.default(e)}}},t.getRolePermissionFactory=function(){return async function({strRoleName:e,strModule:t}){try{return(await s.getMongoDbConnection()).collection(n.CLN_ROLE_PERMISSION).findOne({chrStatus:"N",strRoleName:e,strName:t})}catch(e){throw new a.default(e)}}},t.deleteDBFactory=function(){return async function({strCollection:e,arrDeleteId:t,strModifiedTime:r,strModifiedUser:o}){let n=await s.getMongoDbConnection();try{if((await n.collection(e).find({_id:{$in:t}}).toArray()).length!=t.length)throw new a.default("ITEM_MISMACTH");return await n.collection(e).updateMany({_id:{$in:t}},{$set:{chrStatus:"D",strModifiedTime:r,strModifiedUser:o}}),{}}catch(e){throw new a.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(29),s=r(31),a=r(5),i=o(r(33)),l=o(r(34)),u=o(r(35)),c=o(r(36));let d=i.default({createUserDb:n.createUserDb,userEntity:s.userEntity});t.createUserUsecase=d;let f=l.default({getListDB:a.getListDB});t.getUserUsecase=f;let y=u.default({getUserDetailsDb:n.getUserDetailsDb});t.logInUserUseCase=y;let _=c.default({deleteDB:a.deleteDB});t.deleteUserUsecase=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(30);let n=o.createUserDbFactory();t.createUserDb=n;let s=o.getUserDetailsDbFactory();t.getUserDetailsDb=s;let a=o.getListUserDBFactory();t.getListUserDB=a;let i=o.updateUserDbFactory();t.updateUserDb=i},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),s=o(r(0)),a=r(1),i=r(3);t.createUserDbFactory=function(){return async function({objUser:e}){let t=await n.getMongoDbConnection();try{return await t.collection(a.CLN_USER).insertOne(e),{strMessage:"Success"}}catch(e){let t={strName:"USER NAME ALREADY EXIST",strMobileNo:"MOBILE NUMBER ALREADY EXIST"},r=new s.default;if("MongoError"==e.name&&"11000"==e.code&&(e.keyValue.strName&&r.add(t.strName),e.keyValue.strMobileNo&&r.add(t.strMobileNo),r.isError))throw r;throw new s.default(e)}}},t.updateUserDbFactory=function(){return async function({objQuery:e,objSetUser:t,strTenantId:r}){let o=await n.getMongoDbConnection();try{return(await o.collection(a.CLN_USER).findOneAndUpdate(e,t)).value}catch(e){let t={strName:"USER NAME ALREADY EXIST",strMobileNo:"MOBILE NUMBER ALREADY EXIST",strEmail:"EMAIL ALREADY EXIST"},r=new s.default;if("MongoError"==e.name&&"11000"==e.code&&(e.keyValue.strName&&r.add(t.strName),e.keyValue.strMobileNo&&r.add(t.strMobileNo),e.keyValue.strEmail&&r.add(t.strEmail),r.isError))throw r;throw new s.default(e)}}},t.getListUserDBFactory=function(){return async function({strTenantId:e,arrQuery:t,strType:r}){let o=await n.getMongoDbConnection();try{let e=await o.collection(a.CLN_USER).aggregate(t).toArray();return e.length?(t.pop(),t.pop(),t.push({$count:"intTotalCount"}),{arrList:e,objCount:await o.collection(a.CLN_USER).aggregate(t).toArray()}):{arrList:e,objCount:[{intTotalCount:0}]}}catch(e){throw new s.default(e)}}},t.getUserDetailsDbFactory=function(){return async function({strName:e=null,strMobileNo:t=null,strUserPK:r=null}){let o=await n.getMongoDbConnection();try{let n={chrStatus:"N"};e?n.strName=e:t?n.strMobileNo=t:r&&(n._id=new i.ObjectID(r));let l={};if(l=await o.collection(a.CLN_USER).findOne(n),!l)throw new s.default("INVALID_USER_NAME");return l}catch(e){throw new s.default(e)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(32);let n=o.userEntityFactory();t.userEntity=n;let s=o.userUpdateEntityFactory();t.userUpdateEntity=s},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(2),a=r(3);t.userEntityFactory=function(){return async function({strName:e,strMobileNo:t,strPassword:r,strUserRole:o,strCreatedTime:i,strCreatedUser:l}){try{let u=new n.default;if(e||u.add("NAME_EMPTY"),r||u.add("PASSWORD_ERROR"),u.isError)throw u;if(u.isError)throw u;return{objUser:{strName:e,strMobileNo:t,strHashPassword:await s.hashString(r.trim()),strUserRole:o,chrStatus:"N",strCreatedTime:i||null,strCreatedUser:new a.ObjectID(l)||null}}}catch(e){throw new n.default(e)}}},t.userUpdateEntityFactory=function(){return async function({strName:e,strMobileNo:t,strPassword:r,strUserRole:o,strCreatedTime:i,strCreatedUser:l}){try{let u=new n.default;if(e||u.add("NAME_EMPTY"),r||u.add("PASSWORD_ERROR"),u.isError)throw u;if(u.isError)throw u;return{objUser:{strName:e,strMobileNo:t,strHashPassword:await s.hashString(r.trim()),strUserRole:o,chrStatus:"N",strCreatedTime:i||null,strCreatedUser:new a.ObjectID(l)||null}}}catch(e){throw new n.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0));t.default=function({createUserDb:e,userEntity:t}){return async function({source:r,body:o}){try{let n=await t({...o,strCreatedTime:r.timReceived,strCreatedUser:r.strUserId});return e({objUser:n.objUser})}catch(e){throw new n.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(1);t.default=function({getListDB:e}){return async function({source:t,body:r}){try{t.strUserId;let o={$and:[]};o.$and.push({chrStatus:"N"});let n=[];if(n.push({$match:o}),r.strSort){let e={$sort:{[r.strSort]:"ASC"==r.strSortActive?1:-1}};n.push(e)}let a=Number(r.intPageNo)*Number(r.intLimit&&""!=r.intLimit?r.intLimit:20),i=r.intLimit&&""!=r.intLimit?r.intLimit:20;return await n.push({$limit:Number(i)}),await n.push({$skip:a||0}),{arrList:await e({strCollection:s.CLN_USER,arrQuery:n}),intLimit:i,intPageNo:r.intPageNo||0,...r}}catch(e){throw new n.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),s=o(r(0)),a=r(1);t.default=function({getUserDetailsDb:e}){return async function({source:t,body:r}){if((r.strName||r.strMobileNo)&&!r.strPassword)throw new s.default("CREDENTIAL_MISSING");let o=await e({strName:r.strName||null,strMobileNo:r.strMobileNo||null}),i="";if(!await n.compareHashAndText(r.strPassword,o.strHashPassword))throw new s.default("CREDENTIAL_INVALID");return i=await n.jwtSignIn({strUserId:o._id.toString(),strUserRole:o.strUserRole},{issuer:"ABDU",subject:"123",audience:a.STR_COMMON_DB_TENANT_ID}),delete o.strHashPassword,{strUserToken:i,...o}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=o(r(0)),a=r(3);t.default=function({deleteDB:e}){return async function({source:t,body:r}){try{let o=[];return r.arrDeleteId.forEach(e=>{o.push(new a.ObjectID(e))}),await e({arrDeleteId:o,strCollection:n.CLN_USER,strModifiedTime:t.timReceived,strModifiedUser:t.strUserId}),{strMessage:"DELETE_SUCCESS"}}catch(e){throw new s.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(4)),s=r(2),a=r(38);let i=n.default.Router();i.post("/get_role",s.makeController(a.getUserRoleController)),i.post("/create_role",s.makeController(a.createUserRoleController)),i.post("/get_role_module",s.makeController(a.getUserRoleModuleController)),i.post("/update_role_module",s.makeController(a.updateUserRoleModuleController)),e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=r(39),n=r(46);let s=n.getUserRoleControllerFactory({getUserRoleUsecase:o.getUserRoleUsecase});t.getUserRoleController=s;let a=n.createUserRoleControllerFactory({createUserRoleUsecase:o.createUserRoleUsecase});t.createUserRoleController=a;let i=n.getUserRoleModuleControllerFactory({getUserRoleModuleUsecase:o.getUserRoleModuleUsecase});t.getUserRoleModuleController=i;let l=n.updateUserRoleModuleControllerFactory({updateUserRoleModuleUsecase:o.updateUserRoleModuleUsecase});t.updateUserRoleModuleController=l},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(40),s=r(5),a=o(r(42)),i=o(r(43)),l=o(r(44)),u=o(r(45));let c=i.default({getListDB:s.getListDB});t.getUserRoleUsecase=c;let d=l.default({getListDB:s.getListDB});t.getUserRoleModuleUsecase=d;let f=a.default({userRoleEntity:n.userRoleEntity,inserManyDB:s.inserManyDB,inserOneDB:s.inserOneDB});t.createUserRoleUsecase=f;let y=u.default({deleteManyDB:s.deleteManyDB,inserManyDB:s.inserManyDB});t.updateUserRoleModuleUsecase=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=r(41).userRoleEntityFactory();t.userRoleEntity=o},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(3);t.userRoleEntityFactory=function(){return async function({strRoleName:e,strCreatedTime:t,strCreatedUser:r}){try{let o=new n.default;if(e||o.add("NAME_LENGTH_LESS"),o.isError)throw o;return{strRoleName:e,objUserRole:{strRoleName:e,chrStatus:"N",strCreatedTime:t||null,strCreatedUser:new s.ObjectID(r)||null}}}catch(e){throw new n.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(1);t.default=function({inserOneDB:e,inserManyDB:t,userRoleEntity:r}){return async function({source:o,body:a}){try{let n=await r({...a,strCreatedTime:o.timReceived,strCreatedUser:o.strUserId});await e({objDocument:n.objUserRole,strCollection:s.CLN_USER_ROLE});let i=[];return s.arrModule.forEach(e=>{i.push({strRoleName:n.strRoleName,...e,strCreatedTime:o.timReceived,strCreatedUser:o.strUserId})}),await t({strCollection:s.CLN_ROLE_PERMISSION,arrInsertDocuments:i}),{strMessage:"Success"}}catch(e){throw new n.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(1);t.default=function({getListDB:e}){return async function({source:t,body:r}){try{t.strUserId;let o={$and:[]};o.$and.push({chrStatus:"N"});let n=[];if(n.push({$match:o}),r.strSort){let e={$sort:{[r.strSort]:"ASC"==r.strSortActive?1:-1}};n.push(e)}let a=Number(r.intPageNo)*Number(r.intLimit&&""!=r.intLimit?r.intLimit:20),i=r.intLimit&&""!=r.intLimit?r.intLimit:20;return await n.push({$limit:Number(i)||20}),await n.push({$skip:a||0}),{arrList:await e({strCollection:s.CLN_USER_ROLE,arrQuery:n}),intLimit:i,intPageNo:r.intPageNo||0,...r}}catch(e){throw new n.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=o(r(0));t.default=function({getListDB:e}){return async function({source:t,body:r}){try{if(r.strRoleName){let t={$and:[]};t.$and.push({chrStatus:"N"}),t.$and.push({strRoleName:r.strRoleName});let o=[];o.push({$match:t});let s=await e({strCollection:n.CLN_ROLE_PERMISSION,arrQuery:o});return{...r,arrList:s}}throw new s.default("INVALID USER MODULE")}catch(e){throw new s.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),s=o(r(0));t.default=function({deleteManyDB:e,inserManyDB:t}){return async function({source:r,body:o}){try{if(!o.strRoleName)throw new s.default("ROLE NAME INVALID");if("ADMIN"==o.strRoleName)throw new s.default("CAN'T UPDATE ADMIN ROLE");if(!o.arrModule)throw new s.default("MODULE LIST INVALID");return await e({strCollection:n.CLN_ROLE_PERMISSION,objQuery:{strRoleName:o.strRoleName}}),await t({strCollection:n.CLN_ROLE_PERMISSION,arrInsertDocuments:o.arrModule}),{strMessage:"Success"}}catch(e){throw new s.default(e)}}}},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(0)),s=r(5);t.createUserRoleControllerFactory=function({createUserRoleUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"ROLE",strRoleName:r.strUserRole});if(o&&o.blnCreate)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}},t.getUserRoleControllerFactory=function({getUserRoleUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"ROLE",strRoleName:r.strUserRole});if(o&&o.blnListView)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}},t.getUserRoleModuleControllerFactory=function({getUserRoleModuleUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"ROLE",strRoleName:r.strUserRole});if(o&&o.blnListView)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}},t.updateUserRoleModuleControllerFactory=function({updateUserRoleModuleUsecase:e}){return async function({body:t,...r}){try{let o=await s.getRolePermission({strModule:"ROLE",strRoleName:r.strUserRole});if(o&&o.blnUpdate)return{body:await e({source:r,body:t})};throw new n.default("YOU HAVE NO PERMISSION")}catch(e){return new n.default(e).send()}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(48))},function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(2),s=r(1),a=o(r(0));t.jwtTokenChecking=async function(e,t,r){let o={"Content-Type":"application/json","Last-Modified":new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}))};try{let i=await e.headers["x-access-token"]||e.headers.authorization;if(!i)return t.status(401).set(o).send(new a.default("AUTHORIZATION_TOKEN_HEADER_IS_MISSING").send().body);{let t=i;e.strToken=t;let o={issuer:"ABDU",subject:"123",audience:s.STR_COMMON_DB_TENANT_ID},a=await n.jwtVerify(t,o);e.strUserId=a.strUserId,e.strUserRole=a.strUserRole,r()}}catch(e){return t.status(401).set(o).send(new a.default(e).send().body)}}}]);